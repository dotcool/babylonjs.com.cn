<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>粒子系统 | babylonjs</title>
  <meta name="description" content="babylonjs中文网，专注html5游戏开发，babylonjs的文档翻译和实例分析" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="css/component.css" />
  <link rel="stylesheet" type="text/css" href="css/screen.css" />
  <meta name="generator" content="babylonjs">
  <script src="http://static.duoshuo.com/embed.js"></script>
  
  
  

  

</head>
<body>
<div class="container">
    <div class="mp-pusher" id="mp-pusher">
        <i id="scroll-up" class="fa fa-angle-up"></i>
        <nav id="mp-menu" class="mp-menu">
            <div class="mp-level">
                <a data-pjax class="back-home" style="font-size: 20px" href="/"><h2 ><i class="fa fa-home"></i>
                        首页</h2></a>
                <ul class="first-level">
                    <li>
                        <a class="fa fa-archive" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;归档</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-archive"></i>
                                归档</h2>
                            <a class="mp-back" href="#">返回</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-archive" placeholder="搜索.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/28/05 Cameras/">摄像机</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/04-Materials/">材质</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/03---Position,-Rotation-&amp;-Scaling/">位移，旋转，缩放</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/02-Basic-elements/">基本元素</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/01---Basic-scene/">基础场景</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/15-Shadows/">阴影</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/14-Height-map/">高度地图</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/13 Environment/">环境</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/12 Particles/">粒子系统</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/11   Picking collisions/">点击检测</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/10 Intersect collision object/">碰撞检测</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/09 Cameras and mesh collisions/">摄像机和材质纹理</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/08 Sprites/">精灵</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/07-Animation/">动画</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/06-Lights/">灯光</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/The-Playground/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-Actions/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-PostProcessRenderPipeline/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-merge-meshes/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-handle-rotations-and-translations/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Home/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How to use FresnelParameters/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Entities-exported-from-Blender/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Creating the minified version/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Using-the-VirtualJoysticksCamera-with-Babylon.js/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Babylon.js-file-format/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Converting-a-.babylon-file-to-.incremental.babylon-file/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Caching-the-resources-in-IndexedDB/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Babylon.js-Primer/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Adding-your-own-physics-engine-plugin-to-Babylon.js/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Advanced Texturing/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-bones-and-skeletons/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-SceneOptimizer-tool/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-instances/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-level-of-details/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-lens-flares/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How to use procedural textures?/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Naming-convention/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Optimizing-performances-with-octrees/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Render-scene-on-a-PNG-(Screenshot)/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-postprocesses/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Roadmap/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/How-to-use-multi-views/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Tags/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Using AssetsManager/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Working-with-Blender/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Using-the-debug-layer/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Using-Oculus-Rift-with-Babylon.js/"></a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/12/27/Creating-your-own-file-importer/"></a>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-copy" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;分类</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-copy"></i>
                                分类</h2>
                            <a class="mp-back" href="#">返回</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-category" placeholder="搜索.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-tags" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;标签</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-tags"></i>
                                标签</h2>
                            <a class="mp-back" href="#">返回</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-tag" placeholder="搜索.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    
                    <li>
                        <a class="fa fa-weibo" href="#"><i class="fa fa-angle-left"></i>&nbsp;&nbsp;微博</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-weibo"></i>
                                微博</h2>
                            <a class="mp-back" href="#">返回</a>
                        </div>
                    </li>
                    
                    <li class="mp-pjax"><a class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;关于我们</a></li>
                    <li><a class="fa fa-github" href="http://www.ejiakt.com">&nbsp;&nbsp;&nbsp;E家课堂</a></li>

                </ul>

            </div>
        </nav>
        <div id="pjax">
            <div class="pjax-hidden" style="display: none">
                
                    <a  data-pjax href="/2014/12/28/05 Cameras/">摄像机</a>
                
                    <a  data-pjax href="/2014/12/27/04-Materials/">材质</a>
                
                    <a  data-pjax href="/2014/12/27/03---Position,-Rotation-&amp;-Scaling/">位移，旋转，缩放</a>
                
                    <a  data-pjax href="/2014/12/27/02-Basic-elements/">基本元素</a>
                
                    <a  data-pjax href="/2014/12/27/01---Basic-scene/">基础场景</a>
                
                    <a  data-pjax href="/2014/12/27/15-Shadows/">阴影</a>
                
                    <a  data-pjax href="/2014/12/27/14-Height-map/">高度地图</a>
                
                    <a  data-pjax href="/2014/12/27/13 Environment/">环境</a>
                
                    <a  data-pjax href="/2014/12/27/12 Particles/">粒子系统</a>
                
                    <a  data-pjax href="/2014/12/27/11   Picking collisions/">点击检测</a>
                
                    <a  data-pjax href="/2014/12/27/10 Intersect collision object/">碰撞检测</a>
                
                    <a  data-pjax href="/2014/12/27/09 Cameras and mesh collisions/">摄像机和材质纹理</a>
                
                    <a  data-pjax href="/2014/12/27/08 Sprites/">精灵</a>
                
                    <a  data-pjax href="/2014/12/27/07-Animation/">动画</a>
                
                    <a  data-pjax href="/2014/12/27/06-Lights/">灯光</a>
                
                    <a  data-pjax href="/2014/12/27/The-Playground/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-Actions/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-PostProcessRenderPipeline/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-merge-meshes/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-handle-rotations-and-translations/"></a>
                
                    <a  data-pjax href="/2014/12/27/Home/"></a>
                
                    <a  data-pjax href="/2014/12/27/How to use FresnelParameters/"></a>
                
                    <a  data-pjax href="/2014/12/27/Entities-exported-from-Blender/"></a>
                
                    <a  data-pjax href="/2014/12/27/Creating the minified version/"></a>
                
                    <a  data-pjax href="/2014/12/27/Using-the-VirtualJoysticksCamera-with-Babylon.js/"></a>
                
                    <a  data-pjax href="/2014/12/27/Babylon.js-file-format/"></a>
                
                    <a  data-pjax href="/2014/12/27/Converting-a-.babylon-file-to-.incremental.babylon-file/"></a>
                
                    <a  data-pjax href="/2014/12/27/Caching-the-resources-in-IndexedDB/"></a>
                
                    <a  data-pjax href="/2014/12/27/Babylon.js-Primer/"></a>
                
                    <a  data-pjax href="/2014/12/27/Adding-your-own-physics-engine-plugin-to-Babylon.js/"></a>
                
                    <a  data-pjax href="/2014/12/27/Advanced Texturing/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-bones-and-skeletons/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-SceneOptimizer-tool/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-instances/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-level-of-details/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-lens-flares/"></a>
                
                    <a  data-pjax href="/2014/12/27/How to use procedural textures?/"></a>
                
                    <a  data-pjax href="/2014/12/27/Naming-convention/"></a>
                
                    <a  data-pjax href="/2014/12/27/Optimizing-performances-with-octrees/"></a>
                
                    <a  data-pjax href="/2014/12/27/Render-scene-on-a-PNG-(Screenshot)/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-postprocesses/"></a>
                
                    <a  data-pjax href="/2014/12/27/Roadmap/"></a>
                
                    <a  data-pjax href="/2014/12/27/How-to-use-multi-views/"></a>
                
                    <a  data-pjax href="/2014/12/27/Tags/"></a>
                
                    <a  data-pjax href="/2014/12/27/Using AssetsManager/"></a>
                
                    <a  data-pjax href="/2014/12/27/Working-with-Blender/"></a>
                
                    <a  data-pjax href="/2014/12/27/Using-the-debug-layer/"></a>
                
                    <a  data-pjax href="/2014/12/27/Using-Oculus-Rift-with-Babylon.js/"></a>
                
                    <a  data-pjax href="/2014/12/27/Creating-your-own-file-importer/"></a>
                
                
                
                <a data-pjax class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;关于我们</a>
            </div>
            <nav class="nexus">
                <li  style="border-left: 1px solid #c6d0da;">
                    <a id="trigger" href="#"><i class="fa fa-bars"></i></a>
                </li>
                <li ><a id="nexus-back" data-pjax href="/">babylonjs</a></li>
                
                <div id="nav-container">
                    <div class="post-navbar" style="line-height: 63px;display:none">
                        <li id="navbar-title"><a href="#">粒子系统</a></li>
                        <li id="navbar-toc" style="border-left: none">
                            <a style="padding-right: 15px">
                                <span id="toc-content" >介绍</span><i class="fa fa-chevron-down" ></i>
                            </a>
                            <div class="hidden-box">
                                <ul id="toc"></ul>
                            </div>
                        </li>
                    </div>
                </div>
                
            </nav>

            <div class="scroller">
            <div class="scroller-inner">


<!-- -->
<!--<body class="post-template">-->
<!---->
  

<main class="content" role="main">
    <article class="post" >
    <span class="post-meta">
                  <div class="tag-tile">
                      
                  </div>
                <h1 class="post-title" style="margin: 14px 0;color:#50585D">粒子系统</h1>

                    <div class="post-meta">
                        Post on<span class="fa fa-clock-o"></span>
                        <time datetime="2014-12-27T05:02:49.000Z"
                              itemprop="datePublished">Dec 27 2014</time>
                    </div>
    </span>

        <section class="post-content">
            <p>This tutorial is going to talk about the particle system in BabylonJS. Particles are often small sprites used to simulate hard-to-reproduce phenomena like fire, smoke, water, or abstract visual effects like magic glitter and faery dust.</p>
<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/12.png" alt="Particles"></p>
<p>A picture of <a href="http://www.babylonjs.com/playground/?12" target="_blank" rel="external">the playground’s ParticleSystem demo</a></p>
<h2 id="How_can_I_do_this_?">How can I do this ?</h2>
<p>To perform this magic trick, the first thing to do is to create a new object, which will be the particle emitter. In our case, a box will be our emitting object, representing a particle fountain.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fountain = BABYLON.Mesh.CreateBox(<span class="string">"fountain"</span>, <span class="number">1.0</span>, scene);</div></pre></td></tr></table></figure>

<p>The emitter acts as the source of the particles, and its location in 3D space determines where they are generated and how they move. So pay attention to the location/rotation of this object.<br>In our case, the emitter is our fountain, but if you wish, you can use only a vector (BABYLON.Vector3) as an emitter.</p>
<p>Now, we must create a new (not-rendered) ParticleSystem object:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> particleSystem = <span class="keyword">new</span> BABYLON.ParticleSystem(<span class="string">"particles"</span>, <span class="number">2000</span>, scene, customEffect);</div></pre></td></tr></table></figure>

<p>Simple.  The first parameter is the name, the second parameter is the maximum number of particles, the third parameter is the scene, and the optional fourth parameter is a reference to a shader effect for the particles, overriding the default shader.  I will talk about the fourth parameter further below.</p>
<p>An important part is to define the texture of each particle. Each one will have the same pattern, so choose carefully which one you want. But keep in mind that a single scene can contain multiple particleSystems, and each one can emit particles with unique texture patterns.  Also keep in mind that multiple particle systems can use the same emitter object.<br>Our particle texture is going to be this one:</p>
<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/Flare.png" alt="Flare"></p>
<p>To define the particle’s texture, add a line like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.particleTexture = <span class="keyword">new</span> BABYLON.Texture(<span class="string">"Flare.png"</span>, scene);</div></pre></td></tr></table></figure>

<p>(in the playground demo, we used /textures/flare.png)</p>
<p>For this texture, you can use an optional mask to filter some colors, or filter a part of the alpha channel.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.textureMask = <span class="keyword">new</span> BABYLON.Color4(<span class="number">0.1</span>, <span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">1.0</span>);</div></pre></td></tr></table></figure>

<p>This is the output of this configuration:</p>
<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/12-1.png" alt="TextureMask"></p>
<p>The last main thing to do is to define our emitter that we talked about earlier:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Where the particles comes from</span></div><div class="line">particleSystem.emitter = fountain; <span class="comment">// the starting object, the emitter, a box in this case.</span></div></pre></td></tr></table></figure>

<p>Now you should see your particle system working. But it might not be our final result. We can refine some parameters:</p>
<ul>
<li>Box around our emitter. Our emitter is the center of particles source, but if you want your particles to emit from more than one point, then you can tell it to do so:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">particleSystem.minEmitBox = <span class="keyword">new</span> BABYLON.Vector3(-<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Starting all From</span></div><div class="line">particleSystem.maxEmitBox = <span class="keyword">new</span> BABYLON.Vector3(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// To...</span></div></pre></td></tr></table></figure>

<p>As you can see, particles are emitted from different positions along the X-axis:</p>
<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/12-2.png" alt="EmitBox"></p>
<ul>
<li>Now you can give some colors to your particles. Color one and two are combined, and “colorDead” is the color that the particle takes-on just before it disappears.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Colors of all particles (splited in 2 + specific color before dispose)</span></div><div class="line">particleSystem.color1 = <span class="keyword">new</span> BABYLON.Color4(<span class="number">0.7</span>, <span class="number">0.8</span>, <span class="number">1.0</span>, <span class="number">1.0</span>);</div><div class="line">particleSystem.color2 = <span class="keyword">new</span> BABYLON.Color4(<span class="number">0.2</span>, <span class="number">0.5</span>, <span class="number">1.0</span>, <span class="number">1.0</span>);</div><div class="line">particleSystem.colorDead = <span class="keyword">new</span> BABYLON.Color4(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">0.0</span>);</div></pre></td></tr></table></figure>

<ul>
<li>Size of particles:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Size of each particle (random between...)</span></div><div class="line">particleSystem.minSize = <span class="number">0.1</span>;</div><div class="line">particleSystem.maxSize = <span class="number">0.5</span>;</div></pre></td></tr></table></figure>

<ul>
<li>LifeTime of particles:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Life time of each particle (random between...)</span></div><div class="line">particleSystem.minLifeTime = <span class="number">0.3</span>;</div><div class="line">particleSystem.maxLifeTime = <span class="number">1.5</span>;</div></pre></td></tr></table></figure>

<ul>
<li>Emit rate. This is the density of particles, the rate of particle flow:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.emitRate = <span class="number">1000</span>;</div></pre></td></tr></table></figure>

<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/12-3.png" alt="emitRate"></p>
<p>If you want to launch only a few particles at once, that can be done, as well.  For example, if you want to emit only 300 particles:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.manualEmitCount = <span class="number">300</span>;</div></pre></td></tr></table></figure>

<p>Be aware that the stream is no longer continuous.  This is a one-shot particle emission, so this function overrides the previous “emitRate” parameter.</p>
<ul>
<li>The selected mode for particles. You can choose between “BLENDMODE_ONEONE” (default choice: source color is added to the destination color without alpha affecting the result), and “BLENDMODE_STANDARD” (to blend current color and particle color using particle’s alpha).</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.blendMode = BABYLON.ParticleSystem.BLENDMODE_ONEONE;</div></pre></td></tr></table></figure>

<ul>
<li>Gravity. You can use gravity if you want to give an orientation to your particles (e.g.: fire particles travel upward on the Y-axis)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Set the gravity of all particles (not necessarily down)</span></div><div class="line">particleSystem.gravity = <span class="keyword">new</span> BABYLON.Vector3(<span class="number">0</span>, -<span class="number">9.81</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>

<ul>
<li>Direction. Random direction of each particle after it has been emitted, between direction1 and direction2 vectors.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">particleSystem.direction1 = <span class="keyword">new</span> BABYLON.Vector3(-<span class="number">7</span>, <span class="number">8</span>, <span class="number">3</span>);</div><div class="line">particleSystem.direction2 = <span class="keyword">new</span> BABYLON.Vector3(<span class="number">7</span>, <span class="number">8</span>, -<span class="number">3</span>);</div></pre></td></tr></table></figure>

<p><img src="http://www.babylonjs.com/tutorials/12 - Particles/12-4.png" alt="emitRate"></p>
<ul>
<li>AngularSpeed. You can define a Z-axis rotation for each particle (in radian):</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">particleSystem.minAngularSpeed = <span class="number">0</span>;</div><div class="line">particleSystem.maxAngularSpeed = <span class="built_in">Math</span>.PI;</div></pre></td></tr></table></figure>

<ul>
<li>Speed/Strength. You can define the power of emitting particles, and the overall motion speed (0.01 is default update speed, faster updates = faster animation).</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">particleSystem.minEmitPower = <span class="number">1</span>;</div><div class="line">particleSystem.maxEmitPower = <span class="number">3</span>;</div><div class="line"></div><div class="line">particleSystem.updateSpeed = <span class="number">0.005</span>;</div></pre></td></tr></table></figure>

<ul>
<li>Duration. You can set the amount of time the particle system is running (depends of the overall speed above).</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.targetStopDuration = <span class="number">5</span>;</div></pre></td></tr></table></figure>

<ul>
<li>Dispose. Disposes (or not) the particle system on stop (very useful if you want to create a one shot particle system with a specific targetStopDuration):</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.disposeOnStop = <span class="literal">true</span>;</div></pre></td></tr></table></figure>

<p>Finally, you can start this particle system whenever you want in your code with:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.start();</div></pre></td></tr></table></figure>

<p>And naturally stop it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">particleSystem.stop();</div></pre></td></tr></table></figure>

<p>Feel free to play with this scene… <a href="http://www.babylonjs.com/playground/?12" target="_blank" rel="external">at our online playground</a>.</p>
<h3 id="customEffect_(the_fourth_parameter_in_the_constructor)">customEffect (the fourth parameter in the constructor)</h3>
<p>var ps = new BABYLON.ParticleSystem(“particles”, 2000, scene, <strong>customEffect</strong>);</p>
<p>The customEffect is a type of BABYLON.Effect used to target a valid shader program.</p>
<p>The primary author of Babylon.js was kind enough to make us <a href="http://www.babylonjs.com/playground/#1ASENS" target="_blank" rel="external">a fantastic playground demo of a particle system using a fragment shader effect</a>.  Visit that link, and you can see a fragment shader program that has been stored in a shader store.  Notice the line:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BABYLON.Effect.ShadersStore[<span class="string">"myParticleFragmentShader"</span>] = [...]</div></pre></td></tr></table></figure>

<p>A bit below that, you will see:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> effect = engine.createEffectForParticles(<span class="string">"myParticle"</span>, [<span class="string">"time"</span>]);</div></pre></td></tr></table></figure>

<p><em>.createEffectForParticles</em> accepts the following parameters:</p>
<ul>
<li>fragment name (can be in the shaders store or the id of a DOM element)</li>
<li>array of additional parameters (uniforms)</li>
<li>array of additional samplers (for additional textures!)</li>
</ul>
<p>The particle Effect Object is a slightly-modified <a href="http://www.sokrate.fr/documentation/babylonjs/BABYLON.Effect.html" target="_blank" rel="external">Babylon Effect Object</a>.  Also notice that the ShadersStore is a namespace upon this special <a href="http://www.sokrate.fr/documentation/babylonjs/BABYLON.Effect.html" target="_blank" rel="external">Effect Object</a>.  </p>
<p>The Effect Object has many ‘setter’ methods on it, one of which is <em>.setFloat</em>.  Notice how it is used in the registerBeforeRender function.  This causes the speed of the effect to cycle across about a 20 second time span.  We are (the demo author is) varying the time parameter of the fragment shader program… from within the scene’s render loop!  WE LOVE IT!</p>
<p>Here is a short comment from Deltakosh… regarding that playground demo linked above:</p>
<blockquote>
<p>By default Babylon.js will give you a vUV and a vColor varying parameter. It will also transmit you the particle texture. But you can feel free to add any new parameter, like I did, with ‘time’.</p>
</blockquote>
<p>This section of the tutorial is under construction.  We will have much more to say, soon.</p>
<h2 id="Next_step">Next step</h2>
<p>ParticleSystems are very powerful and versatile tools that can help bring realness and movement to your scenes. Don’t hesitate to use them as they are not resource-intensive.</p>
<p>Stay with us, because we are going to learn a new, very interesting thing: <a href="https://github.com/BabylonJS/Babylon.js/wiki/13-Environment" target="_blank" rel="external">Configuring your environment</a>.</p>

        </section>
        <hr/>
        <nav class="pagination" style="width:auto" role="pagination">
            
            <a data-pjax class="newer-posts" href="/2014/12/27/13 Environment/">← Prev Post</a>
            
            <a class="share-button" data-original-title title>Share this Post</a>
            
            <a data-pjax class="older-posts" href="/2014/12/27/11   Picking collisions/">Next Post →</a>
            
        </nav>
        <br/>
        <br/>
        <section id="comment">
            <div id="comment-box"></div>
        </section>


    </article>
</main>


  
<footer class="site-footer">
    
    <div class="inner">
        <section class="copyright"><a href="/"></a> &copy; babylonjs 2014</section>
        <section class="poweredby">Published with <a target="_blank" href="http://www.ejiakt.com">E家课堂</a></section>
    </div>
</footer>
</div>
</div><!-- /scroller -->

</div><!-- /pusher -->
</div><!-- /container -->
</div>

<!-- Easter eggs -->

<div class="egg animated">
    <a id="close-button" href="#">X</a>
    <div class="block">
        <div class="loading">
            <span class="ball1"></span>
            <span class="ball2"></span>
        </div>
    </div>
</div>
  
<script src="//cdn.staticfile.org/jquery/1.11.0/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "js/jquery.min.js";
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript" src="js/lib.js"></script>
<script type="text/javascript" src="js/main.js"></script>







</body>
</html>
